<script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.5.0/mammoth.browser.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.2/html2pdf.bundle.min.js"></script>

<!-- Your HTML input for file upload -->
<input type="file" id="fileInput" accept=".docx">

<!-- Output PDF button -->
<button onclick="convertToPDF()">Convert to PDF</button>

<!-- Output element for displaying PDF -->
<div id="pdfOutput"></div>

<!-- Download link for the PDF -->
<a id="downloadLink" style="display: none;">Download PDF</a>

<script>
  function convertToPDF() {
    document.getElementById('fileInput').addEventListener('change', function(event) {
      var file = event.target.files[0];
      if (!file) {
        return;
      }

      var reader = new FileReader();
      reader.onload = function(event) {
        var arrayBuffer = event.target.result;
        var uint8Array = new Uint8Array(arrayBuffer);

        mammoth.convertToHtml({ arrayBuffer: arrayBuffer })
          .then(function(result) {
            var html = result.value; // Extracted HTML content
            
            // Convert HTML to PDF using html2pdf.js
            html2pdf().from(html).outputPdf('arraybuffer')
              .then(function(pdfBuffer) {
                // Display PDF content
                document.getElementById('pdfOutput').innerHTML = '<embed src="' + URL.createObjectURL(new Blob([pdfBuffer], { type: 'application/pdf' })) + '" type="application/pdf" width="100%" height="600px" />';
                
                // Show download link
                document.getElementById('downloadLink').style.display = 'inline';
                // Set download link href to Blob URL
                document.getElementById('downloadLink').href = URL.createObjectURL(new Blob([pdfBuffer], { type: 'application/pdf' }));
              })
              .catch(function(error) {
                console.error('An error occurred:', error);
              });
          })
          .catch(function(err) {
            console.error('An error occurred:', err);
          });
      };
      reader.readAsArrayBuffer(file);
    });
  }
</script>
